<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>NLP PA: Hidden Markov Models</title>
<meta name=description content="Moments of Life"><meta name=keywords content="NLP,Coursera"><meta property="og:url" content="https://ctliu3.xyz/posts/nlp-pa-hidden-markov-models/"><meta property="og:type" content="website"><meta property="og:title" content="NLP PA: Hidden Markov Models"><meta property="og:description" content="Moments of Life"><meta property="og:image" content="https://ctliu3.xyz/avatar.png"><meta property="og:image:secure_url" content="https://ctliu3.xyz/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="NLP PA: Hidden Markov Models"><meta name=twitter:description content="Moments of Life"><meta property="twitter:domain" content="https://ctliu3.xyz/posts/nlp-pa-hidden-markov-models/"><meta property="twitter:url" content="https://ctliu3.xyz/posts/nlp-pa-hidden-markov-models/"><meta name=twitter:image content="https://ctliu3.xyz/avatar.png"><link rel=canonical href=https://ctliu3.xyz/posts/nlp-pa-hidden-markov-models/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://ctliu3.xyz/><img src=/avatar.png alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://ctliu3.xyz/>自由の灵魂</a></div><div class=nav-links><div class=nav-link><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>NLP PA: Hidden Markov Models</h1><small role=doc-subtitle></small><p class=post-date>三月 24, 2013</p><ul class=post-tags><li class=post-tag><a href=https://ctliu3.xyz/tags/nlp>NLP</a></li><li class=post-tag><a href=https://ctliu3.xyz/tags/coursera>Coursera</a></li></ul></div><div class=post-content><p><p><a href=https://class.coursera.org/nlangp-001/class/index title=NLP>传送门</a></p><p>HMM 是通过预测一连串的 $y_i$ 来得到模型 $p(x_1 \dots x_n, y_1 \dots y_n)$ 的概率最大值。本周的 Programming 主要是利用 HMM 来做针对句子的词性 tagger。</p><p>$$
p(x_1 \dots x_n, y_1 \dots y_{n+1}) =
\prod_{i=1}^{n+1} q(y_i|y_{i-2},y_{i-1}) \times \prod_{i=1}^n e(x_i|y_i)
$$</p><p>为方便求解，一般把待标注的句子变成*,*,sentence,STOP，即 $ y_0=y_{-1}=*, y_n=STOP $。在标注前，先对数据进行处理：把所有在训练集中出现且次数 &lt;5 的单词替换成 <code>RARE</code>。</p><h1 id=part-1>Part 1</h1><p>作为 baseline，一开始忽略句子内部的联系，用MLE来估计每个 $x_i$ 所属的 tag。也就是求$${\arg\max_y} e(x|y)$$</p><p>其中</p><p>$$
e(x|y) = \frac{Count(x, y)}{Count(y)}
$$</p><p>$Count(x,y)$ 表示 $x$ 和 $y$ 一起出现的概率。如果对于未出现在训练集的词，$p(x\vert y_i)=0$，而无法取 max 值。所以这时把 $x$ 当成是 RARE，对比 $p(RARE\vert y_i)$ 的值。</p><h1 id=part-2>Part 2</h1><p>这部分实现的是Viterbi算法，经典的 $O(n|S|^3)$ 的 DP。DP(i,u,v) 表示以 i 为结尾，前两个连续的单词为 u,v 的最大值。转移方程为</p><p>$$
DP(i,y_i,y_{i-1}) = max{ DP(i-1, y_{i-1}, y_{i-2}) \times p(y_i|y_{i-2},y_{i-1}) \times e(x_i|y_i) }
$$</p><p>初始化$DP(0,*,*) = 1$。目标状态为$DP(n,STOP,u)$。</p><p>求解过程中，对于未出现在训练集中的词，同样当成 RARE 处理。而对于出现在训练集中，而 $Count(x,y)=0$ 的词，其 $e(x\vert y)$ 值为 0。另外，在 DP 过程中，$y_{-1,0,n+1}$ 的 tag 都为已知，所以也要加特判。</p><h1 id=part-3>Part 3</h1><p>为了增加对 <code>RARE</code> 的判别性，这部分把 RARE 再进行了细化，比如全为大写的为一类，出现数字的为一类。</p><p>对于 <code>gene.test</code>，三种方法的 F1-Score 如下：</p><table><thead><tr><th style=text-align:center>#Part 1</th><th style=text-align:center>#Part 2</th><th style=text-align:center>#Part 3</th></tr></thead><tbody><tr><td style=text-align:center>0.26308</td><td style=text-align:center>0.36514</td><td style=text-align:center>0.39519</td></tr></tbody></table><p>除了 #Part 2 跟 Goal F1-Score 差 了0.00030，其他都一致。</p></p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg><script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function topFunction(){smoothScrollToTop()}function smoothScrollToTop(){const e=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))};e()}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#part-1>Part 1</a></li><li><a href=#part-2>Part 2</a></li><li><a href=#part-3>Part 3</a></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2023 ctliu3</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>