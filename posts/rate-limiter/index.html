<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>Rate Limiter</title>
<meta name=description content="Moments of Life"><meta name=keywords content><meta property="og:url" content="https://ctliu3.xyz/posts/rate-limiter/"><meta property="og:type" content="website"><meta property="og:title" content="Rate Limiter"><meta property="og:description" content="Moments of Life"><meta property="og:image" content="https://ctliu3.xyz/avatar.png"><meta property="og:image:secure_url" content="https://ctliu3.xyz/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Rate Limiter"><meta name=twitter:description content="Moments of Life"><meta property="twitter:domain" content="https://ctliu3.xyz/posts/rate-limiter/"><meta property="twitter:url" content="https://ctliu3.xyz/posts/rate-limiter/"><meta name=twitter:image content="https://ctliu3.xyz/avatar.png"><link rel=canonical href=https://ctliu3.xyz/posts/rate-limiter/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://ctliu3.xyz/><img src=/avatar.png alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://ctliu3.xyz/>自由の灵魂</a></div><div class=nav-links><div class=nav-link><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>Rate Limiter</h1><small role=doc-subtitle></small><p class=post-date>十二月 3, 2016</p><ul class=post-tags></ul></div><div class=post-content><p><p>I dig into rate limiter these days. Rate limiter is a tool that limits the number of request in a given short period. Any service only can handle limited requests with limited resources (cpu, memory, etc). Rate limiter prevents service to reach a high load that beyond its load capacity.</p><p>Generally, rate limiter can be implemented using leaky bucket or token bucket algorithms. The main difference between them is the rate accepting a request. The word &ldquo;bucket&rdquo; is really imagery word that can help you catch the idea of the algorithms.</p><p>For leaky bucket algorithm, the time gap between any two adjacent requests should be greater than a fixed value. Therefore, if there comes huge requests in a short period, the requests will through the service one by one, no burstiness happens. However, the burstiness occurs in token bucket algorithm. Before passing the limiter, request should check if there is enough tokens left. If there is, then the request is accepted. The tokens will be refilled in a given period. If many requests get the tokens at almost the same time, then burstiness takes place.</p><p>For a full-featured rate limiter, following points should be considered:</p><ul><li>Multiple request at a time. The requests are packed into batch, they should be handled simultaneously.</li><li>Multiple buckets. Each bucket is used for a namespace, such as user id or host.</li><li>Heterogeneous request type. You need different limiter to handle different type of requests.</li><li>Dynamic configuration. Reconfigure the limiter without restarting it.</li><li>Make it distributed. Multiple same service use a central limiter. But this will make the limiter a little bit heavy and I don&rsquo;t recommend this in some degree.</li><li>etc&mldr;</li></ul><p>In <a href=https://github.com/ctliu3/tap>tap</a>, which is a project in github, I implement the above two algorithms of rate limiter using golang. Also, I also extend the rate limiter to a distributed version, backend with redis. This project is a good start to understand rate limiter, but it&rsquo;s still an experimental project, be careful if you want to use it in production environment. I don&rsquo;t suppose to get into details about the tap because it&rsquo;s not completed finished, you can take a glance on the codes.</p></p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg><script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function topFunction(){smoothScrollToTop()}function smoothScrollToTop(){const e=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))};e()}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents></nav></nav></aside></main><footer class=footer><span>&copy; 2023 ctliu3</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>