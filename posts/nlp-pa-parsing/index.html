<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>NLP PA: Parsing</title>
<meta name=description content="Moments of Life"><meta name=keywords content="NLP,Coursera"><meta property="og:url" content="https://ctliu3.xyz/posts/nlp-pa-parsing/"><meta property="og:type" content="website"><meta property="og:title" content="NLP PA: Parsing"><meta property="og:description" content="Moments of Life"><meta property="og:image" content="https://ctliu3.xyz/avatar.png"><meta property="og:image:secure_url" content="https://ctliu3.xyz/avatar.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="NLP PA: Parsing"><meta name=twitter:description content="Moments of Life"><meta property="twitter:domain" content="https://ctliu3.xyz/posts/nlp-pa-parsing/"><meta property="twitter:url" content="https://ctliu3.xyz/posts/nlp-pa-parsing/"><meta name=twitter:image content="https://ctliu3.xyz/avatar.png"><link rel=canonical href=https://ctliu3.xyz/posts/nlp-pa-parsing/><link rel=stylesheet type=text/css href=/css/normalize.min.css media=print><link rel=stylesheet type=text/css href=/css/main.min.css><link id=dark-theme rel=stylesheet href=/css/dark.min.css><script src=/js/bundle.min.edd985581bf860dfb4507e5885197f1680160c7fe19f23b31e183126d99dd596.js integrity="sha256-7dmFWBv4YN+0UH5YhRl/FoAWDH/hnyOzHhgxJtmd1ZY="></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://ctliu3.xyz/><img src=/avatar.png alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://ctliu3.xyz/>自由の灵魂</a></div><div class=nav-links><div class=nav-link><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://ctliu3.xyz/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://ctliu3.xyz/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://ctliu3.xyz/about><span data-feather=user></span> About</a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>NLP PA: Parsing</h1><small role=doc-subtitle></small><p class=post-date>四月 5, 2013</p><ul class=post-tags><li class=post-tag><a href=https://ctliu3.xyz/tags/nlp>NLP</a></li><li class=post-tag><a href=https://ctliu3.xyz/tags/coursera>Coursera</a></li></ul></div><div class=post-content><p><p>本周的 PA 是对给定的句子求出相应的句法树（Parsing tree）。实际上，Parsing 经常也做为一些实际应用的预处理，比如机器翻译（Machine Translation, MT），因为不同语言的句子结构（如主谓宾）有很大的区别，通过句法分析得到句子的结构及单词词性，再根据不同语言本身的句法特点进行变换。</p><p>在 NLP 中，词类标注（Part-of-speech Tagging, POS）也跟 Parsing 有关系。POS 可以作为 Parsing 的预处理，因为在我们通过 tagging 确定了每个词语的词性时，后续的 Parsing 规则就可以得到简化。不过由于 tagging 也会出现错误，所以加了效果不一定更好。</p><p><a href=http://www.cs.columbia.edu/~mcollins/courses/nlp2011/notes/pcfgs.pdf title=PCFG>PCFG</a> 是一种基于统计、规则的求解 Parsing 的方法，当然该方法已经很早了，只能作为 baseline，不过现在很多的方法和模型还是以此为基础。设有元组</p><p>$$
G = \left( N, \Sigma, S, R, q\right)
$$</p><p>其中，$N$ 为非叶结点（non-terminals），$\Sigma$ 为 Parsing tree 的叶结点（vocabulary），$R$ 为规则（rule），$q$ 为规则的参数（parameter）。在本题中，$R$ 是满足 Chomsky Normal Form（<a href=http://en.wikipedia.org/wiki/Chomsky_normal_form title=CNF>CNF</a>）的，即只有以下两种形式：</p><p>$$
\begin{align*}
& X \to Y_1Y_2, 其中X \in N, Y_1 \in N, Y_2 \in N \\
& X \to Y, 其中X \in N, Y \in \Sigma
\end{align*}
$$</p><h1 id=part-1-20-points>Part 1 (20 points)</h1><p>该步骤跟上次的 HMM tagger 预处理一样，把训练集中的词汇分成两种：出现频率 &lt;5 的为 <code>RARE</code>，否则为 <code>non-RARE</code>，该步骤也可以理解成是一个平滑操作。</p><p>[code]</p><h1 id=part-2-40-points>Part 2 (40 points)</h1><p>得到 Parsing tree 的过程用的是 <a href=http://en.wikipedia.org/wiki/CYK_algorithm title="CKY Algorithm">CKY算法</a>，其实就是个 bottom-up 的 3 维DP。DP(i,j,X) 表示待分析句子的第 i 个单词到第 j 个单词，规则的 left-hand side 为 X 的概率最大值。目标状态为 DP(1,n,&ldquo;SBARQ&rdquo;)，&ldquo;SBARQ&rdquo; 为题目指定的值，当然自己去遍历所有的 symbol 也是可以的。状态转移方程为：</p><p>$$
DP(i,j,X) = max{P(X \to Y \ Z) \times DP(i,s,Y) \times DP(s+1,j,Z) }
$$</p><p>几个要注意的坑：</p><p>1 初始化。初始的部分是 Parsing tree 的叶结点。在 Part 1 中我们已经将训练集分成两类：RARE 和 non-RARE。该初始化必须遵守以下步骤：</p><ul><li>如果 P(X->Xi) 在 <code>parse_train.counts.out</code> 出现过，即说明 Xi 不是 <code>RARE</code>，那么直接赋值 P(X->Xi)；</li><li>否则如果 Xi 没有出现在 <code>parse_train.counts.out</code> 并且 P(X-><code>RARE</code>) 存在，那么赋值 P(X-><code>RARE</code>)；</li><li>否则，赋值为 0。</li></ul><p>因为概率相乘会导致过小的值，可以用 log 转化，当然本题不转也可以。</p><p>2 结果输出。按题目要求，求解得到的 Parsing tree 是用 <code>json</code> 来解析的，比如以下是一个输出结果：</p><p>如果是用 python 直接 <code>print</code> 的话，字符串是以单引号形式出现的，直接用 json 解析会出错。在 VIM 下可以用全局替换命令进行替换：<code>%s/'/"/g</code>。</p><p>[code]</p><h1 id=part-3-1-point>Part 3 (1 point)</h1><p>该部分只是在 Part 2 的基础上，在 Parsing tree 的每个结点上加入了 <code>parent</code> 信息。因为对于原始的 PCFG 来说：Independence assumption is too strong! 由于该信息数据已经给出，所以求解过程跟 Part 2 差不多。只不过这时的 non-terminal 数据量会增加，复杂度会高些。如果你 Part 2 的代码已经是比较优化的，跑 Part 3 的数据也不会慢多少。</p><h1 id=weakness-of-pcfg>Weakness of PCFG</h1><p>作为一个教科书上的算法，PCGF 劣势 >=2：</p><p>1 没有充分利用句中单词带来的信息量。算法过程中只有在求解 $P(X \to X_i)$ 用到了单词的信息，而该信息没有作用到全局上。</p><p>2 没有充分利用句子的结构信息。同样的 rule，同样的 probability value，可能导致不同的 Parsing tree。</p></p></div><div class=prev-next></div><svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top"><path d="M177 159.7l136 136c9.4 9.4 9.4 24.6.0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9.0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9.0L7 329.7c-9.4-9.4-9.4-24.6.0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/></svg><script>let backToTopButton=document.getElementById("btt-button");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTopButton.style.display="block":backToTopButton.style.display="none"}function topFunction(){smoothScrollToTop()}function smoothScrollToTop(){const e=()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;t>0&&(window.requestAnimationFrame(e),window.scrollTo(0,t-t/8))};e()}</script></div><aside class=post-toc><nav id=toc><nav id=TableOfContents><ul><li><a href=#part-1-20-points>Part 1 (20 points)</a></li><li><a href=#part-2-40-points>Part 2 (40 points)</a></li><li><a href=#part-3-1-point>Part 3 (1 point)</a></li><li><a href=#weakness-of-pcfg>Weakness of PCFG</a></li></ul></nav></nav></aside></main><footer class=footer><span>&copy; 2023 ctliu3</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>