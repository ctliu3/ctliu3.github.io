<!doctype html><html><head><title>NLP PA: Parsing</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=https://ctliu3.github.io/scss/journal.min.f4a8de07567a2d29619e0711662ef6251e3e59b642079f99490f654abf89a3c4.css integrity="sha256-9KjeB1Z6LSlhngcRZi72JR4+WbZCB5+ZSQ9lSr+Jo8Q=" media=screen><link rel=stylesheet href=https://ctliu3.github.io/scss/dark-mode.min.eeb8040aa9333250b7fec770f950bfe8ba9b18a5eeeaf2dfef61d84d3956f625.css integrity="sha256-7rgECqkzMlC3/sdw+VC/6LqbGKXu6vLf72HYTTlW9iU=" media=screen><script src=/vendor/js/loadCSS.js></script>
<script>loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons")</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script src=/js/toc.js></script>
<script src=https://cdn.jsdelivr.net/npm/vue-disqus@3/dist/vue-disqus.js></script></head><body><div id=app><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://ctliu3.github.io/><div class=nav-title>Space of ctliu3</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>归档</a>
<a class="a-block nav-link-item false" href=/categories>分类</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2017 Space of ctliu3</div></div><div id=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- 目录 -</center><ul><ul><ul><li><a href=#part-1-20-points onclick="onNavClick(`#part-1-20-points-nav`)" id=part-1-20-points-nav>Part 1 (20 points)</a></li><li><a href=#part-2-40-points onclick="onNavClick(`#part-2-40-points-nav`)" id=part-2-40-points-nav>Part 2 (40 points)</a></li><li><a href=#part-3-1-point onclick="onNavClick(`#part-3-1-point-nav`)" id=part-3-1-point-nav>Part 3 (1 point)</a></li><li><a href=#weakness-of-pcfg onclick="onNavClick(`#weakness-of-pcfg-nav`)" id=weakness-of-pcfg-nav>Weakness of PCFG</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>归档</a>
<a class="a-block drawer-menu-item false" href=/categories>分类</a></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://ctliu3.github.io/>Space of ctliu3</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://ctliu3.github.io/><div class=single-column-header-title>Space of ctliu3</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>NLP PA: Parsing<div class=post-meta><time itemprop=datePublished>2013-04-05 13:57</time>
<i class=material-icons>folder</i>
<a href=/categories/engineering>Engineering</a>
&nbsp;
<i class=material-icons>label</i>
<a href=/tags/nlp>NLP</a>
&nbsp;
<a href=/tags/coursera>Coursera</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><p>本周的 PA 是对给定的句子求出相应的句法树（Parsing tree）。实际上，Parsing 经常也做为一些实际应用的预处理，比如机器翻译（Machine Translation, MT），因为不同语言的句子结构（如主谓宾）有很大的区别，通过句法分析得到句子的结构及单词词性，再根据不同语言本身的句法特点进行变换。</p><p>在 NLP 中，词类标注（Part-of-speech Tagging, POS）也跟 Parsing 有关系。POS 可以作为 Parsing 的预处理，因为在我们通过 tagging 确定了每个词语的词性时，后续的 Parsing 规则就可以得到简化。不过由于 tagging 也会出现错误，所以加了效果不一定更好。</p><p><a href=http://www.cs.columbia.edu/~mcollins/courses/nlp2011/notes/pcfgs.pdf title=PCFG>PCFG</a> 是一种基于统计、规则的求解 Parsing 的方法，当然该方法已经很早了，只能作为 baseline，不过现在很多的方法和模型还是以此为基础。设有元组</p><p>$$
G = \left( N, \Sigma, S, R, q\right)
$$</p><p>其中，$N$ 为非叶结点（non-terminals），$\Sigma$ 为 Parsing tree 的叶结点（vocabulary），$R$ 为规则（rule），$q$ 为规则的参数（parameter）。在本题中，$R$ 是满足 Chomsky Normal Form（<a href=http://en.wikipedia.org/wiki/Chomsky_normal_form title=CNF>CNF</a>）的，即只有以下两种形式：</p><p>$$
\begin{align*}
& X \to Y_1Y_2, 其中X \in N, Y_1 \in N, Y_2 \in N \\
& X \to Y, 其中X \in N, Y \in \Sigma
\end{align*}
$$</p><h3 id=part-1-20-points>Part 1 (20 points)</h3><p>该步骤跟上次的 HMM tagger 预处理一样，把训练集中的词汇分成两种：出现频率 &lt;5 的为 <code>RARE</code>，否则为 <code>non-RARE</code>，该步骤也可以理解成是一个平滑操作。</p><p>[code]</p><h3 id=part-2-40-points>Part 2 (40 points)</h3><p>得到 Parsing tree 的过程用的是 <a href=http://en.wikipedia.org/wiki/CYK_algorithm title="CKY Algorithm">CKY算法</a>，其实就是个 bottom-up 的 3 维DP。DP(i,j,X) 表示待分析句子的第 i 个单词到第 j 个单词，规则的 left-hand side 为 X 的概率最大值。目标状态为 DP(1,n,&ldquo;SBARQ&rdquo;)，&ldquo;SBARQ&rdquo; 为题目指定的值，当然自己去遍历所有的 symbol 也是可以的。状态转移方程为：</p><p>$$
DP(i,j,X) = max{P(X \to Y \ Z) \times DP(i,s,Y) \times DP(s+1,j,Z) }
$$</p><p>几个要注意的坑：</p><p>1 初始化。初始的部分是 Parsing tree 的叶结点。在 Part 1 中我们已经将训练集分成两类：RARE 和 non-RARE。该初始化必须遵守以下步骤：</p><ul><li>如果 P(X->Xi) 在 <code>parse_train.counts.out</code> 出现过，即说明 Xi 不是 <code>RARE</code>，那么直接赋值 P(X->Xi)；</li><li>否则如果 Xi 没有出现在 <code>parse_train.counts.out</code> 并且 P(X-><code>RARE</code>) 存在，那么赋值 P(X-><code>RARE</code>)；</li><li>否则，赋值为 0。</li></ul><p>因为概率相乘会导致过小的值，可以用 log 转化，当然本题不转也可以。</p><p>2 结果输出。按题目要求，求解得到的 Parsing tree 是用 <code>json</code> 来解析的，比如以下是一个输出结果：</p><p>如果是用 python 直接 <code>print</code> 的话，字符串是以单引号形式出现的，直接用 json 解析会出错。在 VIM 下可以用全局替换命令进行替换：<code>%s/'/"/g</code>。</p><p>[code]</p><h3 id=part-3-1-point>Part 3 (1 point)</h3><p>该部分只是在 Part 2 的基础上，在 Parsing tree 的每个结点上加入了 <code>parent</code> 信息。因为对于原始的 PCFG 来说：Independence assumption is too strong! 由于该信息数据已经给出，所以求解过程跟 Part 2 差不多。只不过这时的 non-terminal 数据量会增加，复杂度会高些。如果你 Part 2 的代码已经是比较优化的，跑 Part 3 的数据也不会慢多少。</p><h3 id=weakness-of-pcfg>Weakness of PCFG</h3><p>作为一个教科书上的算法，PCGF 劣势 >=2：</p><p>1 没有充分利用句中单词带来的信息量。算法过程中只有在求解 $P(X \to X_i)$ 用到了单词的信息，而该信息没有作用到全局上。</p><p>2 没有充分利用句子的结构信息。同样的 rule，同样的 probability value，可能导致不同的 Parsing tree。</p><hr width=100% id=EOF><p style=color:#777>最后修改于 2013-04-05</p></div></div><nav class=post-pagination><a class=newer-posts href=https://ctliu3.github.io/posts/tips-you-should-know-about-caffe/>下回<br>Tips you should know about Caffe</a>
<a class=older-posts href=https://ctliu3.github.io/posts/nlp-pa-hidden-markov-models/>上回<br>NLP PA: Hidden Markov Models</a></nav><div class=post-comment-wrapper><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="https://ctliu3.github.io/posts/nlp-pa-parsing/",this.page.identifier="https://ctliu3.github.io/posts/nlp-pa-parsing/"};(function(){var e=document,t=e.createElement("script");t.src="https://ctliu3.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></div></div></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>移植自 <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
2017 Space of ctliu3</div></div><script src=/js/journal.js></script></body></html>